[LANGGRAPH] Graph structure initialized
üß† PartSelect Chat Agent running on http://localhost:3001
üìù Health check: http://localhost:3001/health

[SERVER] Creating NEW session: acf04729-edb9-4abe-b7b5-fde49486fab5

============================================================
[SESSION] Model: null, Part: null, Goal: null
============================================================

[EXTRACT] Parsing message...

[EXTRACT START] MEMORY & EXTRACTION STATE:
  üì¶ MEMORY:
     Model: null
     Part: null
     Goal: null
     Symptoms: []

  üìù LLM extracted: {
  "model": "WDT780SAEM1",
  "part": "PS3406971",
  "symptoms": [],
  "goal": "check_compatibility",
  "email": null
}
  üìù CURRENT STATE goalType: null
  üìù USER MESSAGE: "Can you tell me if this part PS3406971 is compatible with WDT780SAEM1 ?"
  üìù EXTRACTED goal: check_compatibility
  ‚úì Model updated ‚Üí memory: WDT780SAEM1
  ‚úì Part updated ‚Üí memory: PS3406971
  ‚úì Goal UPDATED ‚Üí memory: "check_compatibility"

  ‚úÖ EXTRACT node complete - Updated memory:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: check_compatibility
     Email: null
     Symptoms: []
[ROUTER] ‚úì Goal in memory: "check_compatibility" ‚Üí CHECK_REQUIREMENTS

[CHECK REQUIREMENTS] MEMORY & EXTRACTION STATE:
  üì¶ MEMORY:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: check_compatibility
     Symptoms: []
  üîç LAST EXTRACTION:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: check_compatibility
     Symptoms: []
[CHECK] Checking MEMORY for goal: check_compatibility
[CHECK]   Model in memory: WDT780SAEM1 (required: diagnose/install/compat)
[CHECK]   Part in memory: PS3406971 (required: install/compat)
[CHECK]   Symptoms in memory: none
[CHECK]   Email in memory: none (required: email_summary)
[CHECK] ‚úì All requirements found in memory ‚Üí EXECUTE_TOOL

[EXECUTE TOOL] MEMORY & EXTRACTION STATE:
  üì¶ MEMORY:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: check_compatibility
     Symptoms: []
  üîç LAST EXTRACTION:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: check_compatibility
     Symptoms: []

[EXECUTE] Calling tool for goal: check_compatibility
  Model: WDT780SAEM1, Part: PS3406971, Symptoms: , Email: null
  Calling tool: check_compatibility
  ‚úì Tool executed
  Tool result: ‚úì Part PS3406971 IS compatible with model WDT780SAEM1
  ‚úó Could not parse as JSON, keeping as string

[AGENT] Full output from graph: {
  "userMessage": "",
  "messages": [
    {
      "role": "user",
      "content": "Can you tell me if this part PS3406971 is compatible with WDT780SAEM1 ?"
    },
    {
      "role": "tool",
      "content": "‚úì Part PS3406971 IS compatible with model WDT780SAEM1"
    },
    {
      "role": "assistant",
      "content": "The part PS3406971 is compatible with your model WDT780SAEM1."
    }
  ],
  "productModel": "WDT780SAEM1",
  "partNumber": "PS3406971",
  "symptoms": [],
  "goalType": null,
  "emailAddress": null,
  "lastExtraction": {
    "model": "WDT780SAEM1",
    "part": "PS3406971",
    "symptoms": [],
    "goal": "check_compatibility",
    "email": null
  },
  "finalResponse": "The part PS3406971 is compatible with your model WDT780SAEM1.",
  "lastToolResult": {
    "toolName": "check_compatibility",
    "data": "‚úì Part PS3406971 IS compatible with model WDT780SAEM1"
  }
}

[AGENT] Output from graph:
  productModel: WDT780SAEM1
  partNumber: PS3406971
  goalType: null
  symptoms: []

[AGENT] Session state after update:
  productModel: WDT780SAEM1
  partNumber: PS3406971
  goalType: null
  emailAddress: null
  symptoms: []
  lastToolResult: {
  toolName: 'check_compatibility',
  data: '‚úì Part PS3406971 IS compatible with model WDT780SAEM1'
}
[SERVER] Updated session goalType: null

[SERVER] Using EXISTING session: acf04729-edb9-4abe-b7b5-fde49486fab5
[SERVER]   Current goalType: null

============================================================
[SESSION] Model: WDT780SAEM1, Part: PS3406971, Goal: null
============================================================

[EXTRACT] Parsing message...

[EXTRACT START] MEMORY & EXTRACTION STATE:
  üì¶ MEMORY:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: null
     Symptoms: []

  üìù LLM extracted: {
  "model": null,
  "part": null,
  "symptoms": [],
  "goal": "email_summary",
  "email": "email me"
}
  üìù CURRENT STATE goalType: null
  üìù USER MESSAGE: "Can you email me this conversation?"
  üìù EXTRACTED goal: email_summary
  üîí Model preserved: WDT780SAEM1
  üîí Part preserved: PS3406971
  ‚úì Goal UPDATED ‚Üí memory: "email_summary"
  ‚úì Email updated ‚Üí memory: email me

  ‚úÖ EXTRACT node complete - Updated memory:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: email_summary
     Email: email me
     Symptoms: []
[ROUTER] ‚úì Goal in memory: "email_summary" ‚Üí CHECK_REQUIREMENTS

[CHECK REQUIREMENTS] MEMORY & EXTRACTION STATE:
  üì¶ MEMORY:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: email_summary
     Symptoms: []
  üîç LAST EXTRACTION:
     Model: null
     Part: null
     Goal: email_summary
     Symptoms: []
[CHECK] Checking MEMORY for goal: email_summary
[CHECK]   Model in memory: WDT780SAEM1 (required: diagnose/install/compat)
[CHECK]   Part in memory: PS3406971 (required: install/compat)
[CHECK]   Symptoms in memory: none
[CHECK]   Email in memory: email me (required: email_summary)
[CHECK] ‚úì All requirements found in memory ‚Üí EXECUTE_TOOL

[EXECUTE TOOL] MEMORY & EXTRACTION STATE:
  üì¶ MEMORY:
     Model: WDT780SAEM1
     Part: PS3406971
     Goal: email_summary
     Symptoms: []
  üîç LAST EXTRACTION:
     Model: null
     Part: null
     Goal: email_summary
     Symptoms: []

[EXECUTE] Calling tool for goal: email_summary
  Model: WDT780SAEM1, Part: PS3406971, Symptoms: , Email: email me
  Calling tool: email_summary
  [ERROR] Tool execution failed: Received tool input did not match expected schema

‚úñ Invalid email
  ‚Üí at email

[AGENT] Full output from graph: {
  "userMessage": "",
  "messages": [
    {
      "role": "user",
      "content": "Can you tell me if this part PS3406971 is compatible with WDT780SAEM1 ?"
    },
    {
      "role": "tool",
      "content": "‚úì Part PS3406971 IS compatible with model WDT780SAEM1"
    },
    {
      "role": "assistant",
      "content": "The part PS3406971 is compatible with your model WDT780SAEM1."
    },
    {
      "role": "user",
      "content": "Can you email me this conversation?"
    }
  ],
  "productModel": "WDT780SAEM1",
  "partNumber": "PS3406971",
  "symptoms": [],
  "goalType": null,
  "emailAddress": "email me",
  "lastExtraction": {
    "model": null,
    "part": null,
    "symptoms": [],
    "goal": "email_summary",
    "email": "email me"
  },
  "finalResponse": "Error: Received tool input did not match expected schema\n\n‚úñ Invalid email\n  ‚Üí at email"
}

[AGENT] Output from graph:
  productModel: WDT780SAEM1
  partNumber: PS3406971
  goalType: null
  symptoms: []

[AGENT] Session state after update:
  productModel: WDT780SAEM1
  partNumber: PS3406971
  goalType: null
  emailAddress: email me
  symptoms: []
  lastToolResult: null
[SERVER] Updated session goalType: null
